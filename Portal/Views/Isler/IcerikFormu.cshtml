
@{
    ViewBag.Title = "IcerikFormu";
}


<div class="portlet light portlet-fit portlet-form bordered" id="form_wizard_1">
    <div class="portlet-title">
        <div class="caption">
            <i class=" icon-layers font-green"></i>
            <span class="caption-subject font-green sbold uppercase">Validation States</span>
        </div>
       
    </div>
    <div class="portlet-body">
        <!-- BEGIN FORM-->
       
        @using (@Html.BeginForm("IcerikFormu", "Isler", FormMethod.Post,
 new {  @class = "form-horizontal" }))
        {
            @Html.AntiForgeryToken()
            <div class="form-body">
              
                <div class="form-group has-warning">
                    <label class="control-label col-md-3" for="inputWarning">Firma Adı</label>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="FirmaId" name="FirmaId">
                        <span class="help-block"> Something may have gone wrong </span>
                    </div>
                </div>
                <div class="form-group has-warning">
                    <label class="control-label col-md-3" for="inputWarning">Domain Adı</label>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="DomainId" name="DomainId">
                        <span class="help-block"> Something may have gone wrong </span>
                    </div>
                </div>
       
                <div class="form-group has-success">
                    <label class="control-label col-md-3" for="inputSuccess">Input with success</label>
                    <div class="col-md-4">
                      
                        <textarea class="ckeditor form-control" name="editor" id="notlar" rows="6" data-error-container="#editor2_error"></textarea>
                        @Html.Partial("CKEditor")   
                    
                    </div>
                </div>
                <div class="form-group has-warning">
                    <label class="control-label col-md-3" for="inputWarning">Logo Alindi</label>
                    <div class="col-md-4">
                    
                        <label>
                            <input type="checkbox" class="form-control icheck icheckbox_minimal-blue" id="LogoAlindi" name="LogoAlindi">
                        </label>
                        <span class="help-block"> Something may have gone wrong </span>
                    </div>
                </div>
                <div class="form-group has-warning">
                    <label class="control-label col-md-3" for="inputWarning">Kurumsal Kimlik Alindi</label>
                    <div class="col-md-4">

                        <label>
                            <input type="checkbox" class="form-control icheck icheckbox_minimal-blue" id="KurumsalKimlikAlindi" name="LogoAlindi">
                        </label>
                        <span class="help-block"> Something may have gone wrong </span>
                    </div>
                </div>
              
            </div>
            <div class="form-actions">
                <div class="row">
                    <div class="col-md-offset-3 col-md-9">
                        <button type="button" class="btn green" onclick="submitForm()">Submit</button>
                        <button type="button" class="btn default">Cancel</button>
                    </div>
                </div>
            </div>

        }
     
        <!-- END FORM-->
    </div>
</div>

@section css{
<link href="/Content/assets/global/plugins/typeahead/typeahead.css" rel="stylesheet" type="text/css" />
<link href="/Content/assets/global/plugins/icheck/skins/all.css" rel="stylesheet" type="text/css" />
}
@section scripts{
<script src="/Content/assets/global/plugins/icheck/icheck.min.js" type="text/javascript"></script>
<script src="/Content/assets/global/plugins/typeahead/handlebars.min.js" type="text/javascript"></script>
<script src="/Content/assets/global/plugins/typeahead/typeahead.bundle.min.js" type="text/javascript"></script>
    <script>
        var icerikFormu = {
            firmaId:null,
            domainId: 0,
            telefon1: "",
            notlar: "",
            logoAlindi: "",
            kurumsalKimlikAlindi: "",
            sayfalarAlindi: "",
            urunlerAlindi: "",
            fotograflarAlindi: "",
            kurumsalDokumanlarAlindi: "",
            referanslarAlindi: "",
            notlar:""

        }
        var selectedDatum;
        $(function () {


           
            var firmas = new Bloodhound({
                datumTokenizer: function (datum) {
                    return Bloodhound.tokenizers.whitespace(datum.label);
                },
                queryTokenizer: Bloodhound.tokenizers.whitespace,
                remote: {
                    wildcard: '%firmaAdi',
                    url: '/Isler/FirmalariGetir?firmaAdi=%firmaAdi',
                    transform: function (response) {
                      
                        return response;
                        /*
                        return $.map(response, function (movie) {
                            return {
                                label: movie.label
                            };
                        });
                        */
                    }
                }
            });

            // Instantiate the Typeahead UI
            $('#FirmaId').typeahead(null, {
                display: 'label',
                displayKey:'value',
                hint: true,
                minLength: 1,
                source: firmas
            });

            $('#FirmaId').on('typeahead:selected', function (event, datum) {
                icerikFormu.firmaId = datum.value;
            });
            //DomainId
            var domains = new Bloodhound({
                datumTokenizer: function (datum) {
                    return Bloodhound.tokenizers.whitespace(datum.label);
                },
                queryTokenizer: Bloodhound.tokenizers.whitespace,
                remote: {
                    wildcard: '%domainAdi',
                    url: '/Isler/DomainGetir',
                    replace: function (url, query) {
                        url += '?domainAdi=' + encodeURIComponent($("#DomainId").val()) + '&firmaId=';
                        if ($('#FirmaId').val() == "") {
                            icerikFormu.firmaId = null;
                        }
                        url += encodeURIComponent(icerikFormu.firmaId);

                        return url;
                    },
                  
                    transform: function (response) {

                        return response;
                        /*
                        return $.map(response, function (movie) {
                            return {
                                label: movie.label
                            };
                        });
                        */
                    }
                }
            });

            // Instantiate the Typeahead UI
            $('#DomainId').typeahead(null, {
                display: 'label',
                displayKey: 'value',
                hint: true,
                minLength: 1,
                source: domains
            });

            $('#DomainId').on('typeahead:selected', function (event, datum) {
                icerikFormu.domainId = datum.value;
                icerikFormu.firmaId = datum.firmaId;
                $('#FirmaId').val(datum.firmaAdi);

            });
     
          
           
        
       
       
          

   
        })
    </script>
    <script>
    
        function submitForm() {
            //var url = @Url.Action("IcerikFormu")+"?";
            icerikFormu.logoAlindi = $('#LogoAlindi').is(':checked') ? "Logo Alindi" : "Logo Alinmadi";
            icerikFormu.kurumsalKimlikAlindi = $('#KurumsalKimlikAlindi').is(':checked') ? "Kurumsal Kimlik Alındı" : "Kurumsal Kimlik Alınmadı";
            icerikFormu.notlar = CKEDITOR.instances["notlar"].getData();
            $.ajax({
                url: '/Isler/IcerikKaydet',
                type: 'get',
                data:'json='+ JSON.stringify(icerikFormu),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $('#ExpirationDates').val(data);
                }
            });
            //document.forms[0].action=url;
            //document.forms[0].submit();
        }
    </script>

}