@using Portal.Models;
@using System.Globalization;
@using Newtonsoft.Json;
@using Portal.Models.IslerModels;
@{
    ViewBag.Title = "MesaiCizelgesi";
    var kullanicilar = Database.DbHelper.GetDb.AspNetUsers.Where(x => x.LockoutEnabled == false)
        .Select(x => new Kullanici { Id = x.Id, AdSoyad = x.Isim + " " + x.SoyIsim }).ToList();
}


<div ng-controller="mesaiCizelgesiCtrl" ng-init="init('@JsonConvert.SerializeObject(kullanicilar)','@ViewBag.guncelKullanici.Id')">
    <form class="form-inline" role="form" style="background-color:#e7ecf1">
        <div class="form-group">          
            <select class="form-control" ng-model="guncelKullaniciId" ng-change="getirData()" >
                <option ng-repeat="k in kullanicilar" value="{{k.Id}}">{{k.AdSoyad}}</option>        
            </select>
        </div>
        <div class="form-group">
            <select class="form-control" name="year"  ng-model="yil" ng-change="getirData()">
               <option ng-repeat="y in yillar" ng-value="{{y}}">{{y}}</option>
            </select>
        </div>
        <div class="form-group">
            
            <select class="form-control" name="month"  ng-model="ay" ng-change="getirData()">
                <option ng-repeat="a in aylar" ng-value="{{a.val}}">{{a.ad}}</option>
            </select>
        </div>
        <button type="button" class="btn btn-default green" ng-click="getirData()">Filtrele</button>
        <button type="button" class="btn btn-default red clearfix" style="float:right" onclick="printPage()">Yazdır</button>
    </form>
    <div style="position:absolute;top:45%;left:55%;right:0;margin:auto" ng-show="yukleniyor">
        <i class="fa fa-refresh fa-spin fa-3x fa-fw font-blue"></i>
    </div>
  
    <p>{{gunSayisi}}</p>
    <div class="portlet-body flip-scroll" style="margin-top:15px">
        <table class="table table-bordered table-striped table-condensed flip-content">
            <thead class="flip-content">
                <tr>
                 
                    <th> Tarih </th>
                    <th> Gün </th>
                    <th> Giriş</th>
                    <th> Çıkış </th>
                    <th> Saat(+/-)</th>
                    <th> Durum </th>                  
                </tr>
            </thead>
            <tbody>            

                <tr ng-repeat="x in getGunler()" >
                  
                    <td>{{getTarih(x)}} </td>
                    <td> {{getGun(x)}} </td>
                    <td> <a href="#" class="mesai" data-pk="{{getColumnValue(x,'Id')}}" column="GirisSaat" >{{getColumnValue(x,'GirisSaat') | trim}} </a>  </td>
                    <td> <a href="#" class="mesai" data-pk="{{getColumnValue(x,'Id')}}" column="CikisSaat" >{{getColumnValue(x,'CikisSaat') | trim}} </a>  </td>
                    <td> <a href="#" class="mesai" data-pk="{{getColumnValue(x,'Id')}}" column="MesaiSuresi" >{{getColumnValue(x,'MesaiSuresi') | trim}} </a>  </td>
                    <td> {{x}} </td>              

                  
                </tr>
            </tbody>
        </table>
    </div>
    <div class="portlet-body flip-scroll" style="margin-top:15px">
        <table class="table table-bordered table-striped table-condensed flip-content">
            <thead class="flip-content">
                <tr>

                    <th> Tarih </th>
                    <th> Gün </th>
                    <th> Giriş</th>
                    <th> Çıkış </th>
                    <th> Saat(+/-)</th>
                    <th> Durum </th>
                </tr>
            </thead>
            <tbody>

                <tr>

                    <td>t</td>
                    <td> </td>
                    <td> <a href="#" class="mesai" data-pk="1" data-title="">ddfv </a>  </td>
                    <td> <a href="#" class="mesai" data-pk="2" data-title="">565 </a>  </td>
                    <td> <a href="#" class="mesai" data-pk="3" data-title="">ewe </a>  </td>
                    <td> 3 </td>


                </tr>
            </tbody>
        </table>
    </div>
</div>
@section css{

    <link href="/Content/assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css" />
    <link href="/Content/assets/global/plugins/typeahead/typeahead.css" rel="stylesheet" type="text/css" />
    <link href="/Content/assets/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css" />

    <style>
        .clearfix:after {
            content: ".";
            visibility: hidden;
            display: block;
            height: 0;
            clear: both;
        }

        .datepicker.dropdown-menu {
            z-index: 9999 !important;
        }

        .flip-content a {
                        color: #32c5d2 !important;
            font-weight: 600 !important;
                    }
    </style>
}
@section scripts{
    <script src="/Content/assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
    <script src="/Content/assets/global/plugins/typeahead/typeahead.bundle.min.js" type="text/javascript"></script>


    <script src="/js/services/mesaiCizelgesiService.js?v=5"></script>
    <script src="/js/controllers/mesaiCizelgesiCtrl.js?v=11"></script>
    <script src="/Content/assets/global/plugins/moment.min.js" type="text/javascript"></script>
<script src="/content/assets/global/plugins/jquery-inputmask/jquery.inputmask.bundle.min.js" type="text/javascript"></script>
<script src="/Content/assets/global/plugins/bootstrap-editable/bootstrap-editable/js/bootstrap-editable.js" type="text/javascript"></script>
    <script>
    function printPage() {
                            window.print();
                        }
    $(function () {
        //$.fn.editable.defaults.mode = 'popup';
        //$('.mesai').editable({
        //    url: '/Yonetim/SatisFiyatDegistir',
        //    //params: { domainId: $(this).data('pk'), note: $(this).data('name') },
        //    type: 'text',
        //    name: 'mesai',
        //    title: '',
        //    success: function (response, newValue) {
        //        console.log(newValue);
        //        //userModel.set('username', newValue); //update backbone model
        //    },
        //    validate: function (x) {
        //        let result = confirm("Fiyat değişecek emin misiniz?", function (result) {
        //            if (result == false) {
        //                return "invalid";
        //            } else {
        //                return "";
        //            }
        //        });
        //    }
        //});
    });

    </script>
}




