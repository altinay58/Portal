@using Portal.Models;
@using System.Globalization;
@{
    ViewBag.Title = "MesaiCizelgesi";
}


<div ng-controller="mesaiCizelgesiCtrl" ng-init="init()">
    <form class="form-inline" role="form" style="background-color:#e7ecf1">
        <div class="form-group">          
            <select class="form-control">
                @foreach (AspNetUser user in ViewBag.kullanicilar)
                {
                  
                        if (ViewBag.guncelKullanici.Id == user.Id)
                        {
                            <option value="@user.Id" selected="selected"><text>@user.Isim</text>&nbsp;<text>@user.SoyIsim</text>   </option>
                        }
                        else
                        {
                            <option value="@user.Id"><text>@user.Isim</text>&nbsp;<text>@user.SoyIsim</text>   </option>
                        }                                  
                
                }
            </select>
        </div>
        <div class="form-group">
            <select class="form-control" name="year1" >
                @{
                    int basYil = 2016;
                    int sonYil = DateTime.Now.Year;
                    for (int i = basYil; i <= sonYil; i++)
                    {
                        if (i == sonYil)
                        {
                            <option value="@i" selected="selected">@i</option>
                        }
                        else
                        {
                            <option value="@i">@i</option>
                        }



                    }
                }

            </select>
        </div>
        <div class="form-group">
            
            <select class="form-control" name="year1">
                @{                  
                    int ay = DateTime.Now.Month;
                    for (int i = 0; i < 12; i++)
                    {
                        if ((i+1) == ay)
                        {
                            <option value="@i+1" selected="selected">@CultureInfo.CurrentUICulture.DateTimeFormat.MonthNames[i]</option>
                        }
                        else
                        {
                            <option value="@i+1">@CultureInfo.CurrentUICulture.DateTimeFormat.MonthNames[i]</option>
                        }



                    }
                }

            </select>
        </div>
        <button type="button" class="btn btn-default green" ng-click="getirData()">Filtrele</button>
        <button type="button" class="btn btn-default red clearfix" style="float:right" onclick="printPage()">Yazdır</button>
    </form>
    <div style="position:absolute;top:45%;left:55%;right:0;margin:auto" ng-show="yukleniyor">
        <i class="fa fa-refresh fa-spin fa-3x fa-fw font-blue"></i>
    </div>
    <div class="portlet-body flip-scroll" style="margin-top:15px">
        <table class="table table-bordered table-striped table-condensed flip-content">
            <thead class="flip-content">
                <tr>
                    <th> Id </th>
                    <th> İş Adı </th>
                    <th> Firma</th>
                    <th> Domain </th>
                    <th> İşi Veren Kişi</th>
                    <th> İşi Yapacak Kişi(ler) </th>
                    <th> İşin Durumu </th>
                    <th> Tarih </th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td> </td>
                    <td> <input type="text" name="isAdi" ng-model="isAdi" ng-keyup="getirData(isAdi)" placeholder="İş Adı" autocomplete="off" class="form-control" /></td>
                    <td>  </td>
                    <td>  </td>
                    <td> &nbsp; </td>
                    <td>  </td>
                    <td> </td>
                    <td> &nbsp; </td>
                    <td>  </td>
                </tr>

                <tr ng-repeat="x in isler">
                    <td>{{x.Id}} </td>
                    <td> {{x.IsAdi}} </td>
                    <td> {{x.Firma}} </td>
                    <td> {{x.Domain}} </td>
                    <td> {{x.IsiVerenKisi}} </td>
                    <td> {{x.IsiYapacakKisi}} </td>
                    <td> {{x.IsinDurumu}} </td>
                    <td> {{tarihFormat(x.Tarih)}} </td>

                    <td> <span><a href="/Isler/IsEkleDuzenle/{{x.Id}}">Düzenle</a></span> </td>
                </tr>




            </tbody>
        </table>
    </div>

</div>
@section css{

    <link href="/Content/assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css" />
    <link href="/Content/assets/global/plugins/typeahead/typeahead.css" rel="stylesheet" type="text/css" />
    <link href="/Content/assets/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css" />

    <style>
        .clearfix:after {
            content: ".";
            visibility: hidden;
            display: block;
            height: 0;
            clear: both;
        }

        .datepicker.dropdown-menu {
            z-index: 9999 !important;
        }

        .flip-content a {
                        color: #32c5d2 !important;
            font-weight: 600 !important;
                    }
    </style>
}
@section scripts{
    <script src="/Content/assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" type="text/javascript"></script>
    <script src="/Content/assets/global/plugins/typeahead/typeahead.bundle.min.js" type="text/javascript"></script>


    <script src="/js/services/mesaiCizelgesiService.js?v=2"></script>
    <script src="/js/controllers/mesaiCizelgesiCtrl.js?v=2"></script>
    <script src="/Content/assets/global/plugins/moment.min.js" type="text/javascript"></script>
    <script>
    function printPage() {
                            window.print();
                        }
    $(function () {
        $.fn.datepicker.dates['tr'] = {
                            days: ["Pazar", "Pazartesi", "Salı", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"],
            daysShort: ["Paz", "Pzt", "Sal", "Çar", "Per", "Cum", "Cmt", "Paz"],
            daysMin: ["Paz", "Pzt", "Sal", "Çar", "Per", "Cum", "Cmt", "Paz"],
            months: ["Ocak", "Şubat", "Mart", "Nisan", "Mayıs", "Haziran", "Temmuz", "Ağustos", "Eylül", "Ekim", "Kasım", "Aralık"],
            monthsShort: ["Oca", "Şub", "Mar", "Nis", "May", "Haz", "Tem", "Ağu", "Eyl", "Eki", "Kas", "Ara"],
            today: "Bugün"
        };


        $("input[is-date='1']").datepicker({
                            autoclose: true,
            language: 'tr'
        });
        @*$("input[is-date='1']").val("@System.DateTime.Today.ToString("dd.MM.yyyy")");*@
        $("input[is-date='1']").datepicker('update');
        $("input[is-date='1']").parent('.input-group').on('click', '.input-group-btn', function (e) {
            e.preventDefault();
            $(this).parent('.input-group').find("input[is-date='1']").datepicker('show');
        });
    })

    </script>
}




